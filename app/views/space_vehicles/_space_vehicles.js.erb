<script type="text/javascript">
  // check for errors and validations
  $('form').submit(function(e){
    var engine_power = $('#space_vehicle_engine_power').val();
    var vehicle_type = $('#space_vehicle_vehicle_type option:selected').val();
    var start_date = new Date($('#space_vehicle_start_date').val());
    var delivery_date = new Date($('#space_vehicle_delivery_date').val());
    var can_carry = $('#space_vehicle_can_carry').val();
    var all_ids = '#space_vehicle_name, #space_vehicle_engine_power, #space_vehicle_start_date, #space_vehicle_delivery_date, #space_vehicle_can_carry'
    if($('.error').length > 0){
      e.preventDefault();
      $("html, body").animate({ scrollTop: 0 }, 1000);
    }
    $('.error').remove();

    $(all_ids).each(function () {
      if(get_value(this.id) == ""){
        e.preventDefault();
        var errorMessage = "You can't leave this empty.";
        display_error(this.id, errorMessage);
      }
    });

    if(isNaN(can_carry) == true){
      e.preventDefault();
      var errorMessage = "Value must be numeric and positive";
      display_error("space_vehicle_can_carry", errorMessage);
    }

    if(vehicle_type == "satellite"){
      if(can_carry > (engine_power/2)){
        e.preventDefault();
        var errorMessage = "A satellite can only carry a number of kilograms equal to half its engine’s power rating.";
        display_error("space_vehicle_can_carry", errorMessage); 
      }
    }

    if(start_date > delivery_date){
      e.preventDefault();
      var errorMessage = "Delivery date should be greater than Start date";
      display_error("space_vehicle_delivery_date", errorMessage); 
    }

  });

  // function of append error message to element
  function display_error(element_id, errorMessage){
    $('#'+element_id).after('<div class="error error-'+element_id+'" >'+errorMessage+'</div>');
  }

  // function of get value of element_id
  function get_value(element){
    return $('#'+element).val();
  }

  // function to remove error message div of specific element
  function clear_errors(element_id){
    $('.error.error-'+element_id).hide();
  }

  $(document).ready(function() {
    var all_ids = '#space_vehicle_name, #space_vehicle_engine_power, #space_vehicle_start_date, #space_vehicle_delivery_date, #space_vehicle_can_carry'

    $(all_ids).focus(function () {
      clear_errors(this.id);
    });

    $(all_ids).blur(function () {
      if(get_value(this.id) == ""){
        var errorMessage = "You can't leave this empty.";
        display_error(this.id, errorMessage);
      }
    });

    $('#space_vehicle_engine_power').blur(function () {
      if(get_value(this.id) < 0 || get_value(this.id) > 90){
        var errorMessage = "Engine Power should be inbetweeen 0 to 90";
        display_error("space_vehicle_engine_power", errorMessage); 
      }
    });


    $('#space_vehicle_vehicle_type').change(function(event) {
        var vehicle_type = $('#space_vehicle_vehicle_type option:selected').val();
        if(vehicle_type == "satellite"){
          $('.carry_type').html("<strong>Kilograms</strong>");
        }
        else{
          $('.carry_type').html("<strong>People</strong>"); 
        }
    });

    $('#space_vehicle_can_carry').blur(function () {
      var vehicle_type = $('#space_vehicle_vehicle_type option:selected').val();
      if(vehicle_type == "satellite"){
        if(get_value(this.id) > (get_value('space_vehicle_engine_power')/2)){
          var errorMessage = "A satellite can only carry a number of kilograms equal to half its engine’s power rating.";
          display_error(this.id, errorMessage); 
        }
      }
    });

    $('#space_vehicle_start_date, #space_vehicle_delivery_date').blur(function () {
      start_date = new Date(get_value('space_vehicle_start_date'));
      delivery_date = new Date(get_value('space_vehicle_delivery_date'));
      if(start_date > delivery_date){
        var errorMessage = "Delivery date should be greater than Start date";
        display_error("space_vehicle_delivery_date", errorMessage); 
      }
    });

    // allow only numbers to enter in engine_power and can_carry field
    $('#space_vehicle_engine_power, #space_vehicle_can_carry').keyup(function () {
      if (this.value != this.value.replace(/[^0-9\.]/g, '')) {
         this.value = this.value.replace(/[^0-9\.]/g, '');
      }
    });

    $('[data-behaviour~=datepicker]').datepicker({
      todayHighlight: true
    });

  });


</script>